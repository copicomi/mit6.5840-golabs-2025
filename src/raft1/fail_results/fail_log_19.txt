2025/09/12 19:46:24 [0] S0 restart!!
2025/09/12 19:46:24 [0] S1 restart!!
2025/09/12 19:46:24 [0] S2 restart!!
Test (3D): install snapshots (crash) (unreliable network)...
2025/09/12 19:46:25 [1] S2 start election...
2025/09/12 19:46:25 [1] S2 Got Vote reply from 1, term 1
2025/09/12 19:46:25 [1] S2 Change to leader
2025/09/12 19:46:25 [1] S2 Got Vote reply from 0, term 1
2025/09/12 19:46:25 [1] S1 Got append RPC with pervLogIndex 0 loglen 0 term 1
2025/09/12 19:46:25 [1] S1 , apply 0, commit 0, log 0, snapshot 0, len 1
2025/09/12 19:46:25 [1] S0 Got append RPC with pervLogIndex 0 loglen 0 term 1
2025/09/12 19:46:25 [1] S0 , apply 0, commit 0, log 0, snapshot 0, len 1
2025/09/12 19:46:25 [1] S2 start one(5015470162425668483)
2025/09/12 19:46:25 [1] S2 Append 1 logs, lastLogIndex = 1
2025/09/12 19:46:25 [1] S1 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:25 [1] S1 , apply 0, commit 0, log 0, snapshot 0, len 1
2025/09/12 19:46:25 [1] S0 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:25 [1] S0 , apply 0, commit 0, log 0, snapshot 0, len 1
2025/09/12 19:46:25 [1] S2 send APPEND ENTRIES RPC to server 0, prev 0, loglen 1, term 1
2025/09/12 19:46:25 [1] S0 Got append RPC with pervLogIndex 0 loglen 1 term 1
2025/09/12 19:46:25 [1] S0 , apply 0, commit 0, log 0, snapshot 0, len 1
2025/09/12 19:46:25 [1] S0 Append 1 logs, lastLogIndex = 1
2025/09/12 19:46:25 [1] S2 Update commit index to 1
2025/09/12 19:46:25 [1] S2 Apply 1 logs to 1
2025/09/12 19:46:25 [1] S2 begin apply log 1
2025/09/12 19:46:25 [1] S2 APPLY , apply 0, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:25 [1] S2 end apply log 1
2025/09/12 19:46:25 [1] S0 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:25 [1] S0 , apply 0, commit 0, log 1, snapshot 0, len 2
2025/09/12 19:46:25 [1] S1 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:25 [1] S1 , apply 0, commit 0, log 0, snapshot 0, len 1
2025/09/12 19:46:25 [1] S2 send APPEND ENTRIES RPC to server 1, prev 0, loglen 1, term 1
2025/09/12 19:46:25 [1] S0 Apply 1 logs to 1
2025/09/12 19:46:25 [1] S0 begin apply log 1
2025/09/12 19:46:25 [1] S0 APPLY , apply 0, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:25 [1] S0 end apply log 1
2025/09/12 19:46:25 [1] S1 Got append RPC with pervLogIndex 0 loglen 1 term 1
2025/09/12 19:46:25 [1] S1 , apply 0, commit 0, log 0, snapshot 0, len 1
2025/09/12 19:46:25 [1] S1 Append 1 logs, lastLogIndex = 1
2025/09/12 19:46:25 [1] S1 Apply 1 logs to 1
2025/09/12 19:46:25 [1] S1 begin apply log 1
2025/09/12 19:46:25 [1] S1 APPLY , apply 0, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:25 [1] S1 end apply log 1
2025/09/12 19:46:25 [1] S0 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:25 [1] S0 , apply 1, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:25 [1] S1 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:25 [1] S1 , apply 1, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:25 [1] S0 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:25 [1] S0 , apply 1, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:25 [1] S1 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:25 [1] S1 , apply 1, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:25 [1] S0 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:25 [1] S0 , apply 1, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:25 [1] S1 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:25 [1] S1 , apply 1, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:26 [1] S1 , apply 1, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:26 [1] S0 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:26 [1] S0 , apply 1, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:26 [1] S1 , apply 1, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:26 [1] S0 Got append RPC with pervLogIndex 1 loglen 0 term 1
2025/09/12 19:46:26 [1] S0 , apply 1, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:26 [1] S2 start one(7305426334808330301)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 2
2025/09/12 19:46:26 [1] S2 send APPEND ENTRIES RPC to server 1, prev 1, loglen 1, term 1
2025/09/12 19:46:26 [1] S2 send APPEND ENTRIES RPC to server 0, prev 1, loglen 1, term 1
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 2 loglen 0 term 1
2025/09/12 19:46:26 [1] S1 , apply 1, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 1 loglen 1 term 1
2025/09/12 19:46:26 [1] S1 , apply 1, commit 1, log 1, snapshot 0, len 2
2025/09/12 19:46:26 [1] S1 Append 1 logs, lastLogIndex = 2
2025/09/12 19:46:26 [1] S2 Update commit index to 2
2025/09/12 19:46:26 [1] S2 Apply 1 logs to 2
2025/09/12 19:46:26 [1] S2 begin apply log 2
2025/09/12 19:46:26 [1] S2 APPLY , apply 1, commit 2, log 2, snapshot 0, len 3
2025/09/12 19:46:26 [1] S2 end apply log 2
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 2 loglen 0 term 1
2025/09/12 19:46:26 [1] S1 , apply 1, commit 1, log 2, snapshot 0, len 3
2025/09/12 19:46:26 [1] S1 Apply 1 logs to 2
2025/09/12 19:46:26 [1] S1 begin apply log 2
2025/09/12 19:46:26 [1] S1 APPLY , apply 1, commit 2, log 2, snapshot 0, len 3
2025/09/12 19:46:26 [1] S1 end apply log 2
2025/09/12 19:46:26 [1] S2 start one(9221058893790135339)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 3
2025/09/12 19:46:26 [1] S2 start one(6360849936283819423)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 4
2025/09/12 19:46:26 [1] S2 start one(5549084102196452845)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 5
2025/09/12 19:46:26 [1] S2 start one(2449762996560358551)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 6
2025/09/12 19:46:26 [1] S2 start one(7401989370345871297)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 7
2025/09/12 19:46:26 [1] S2 start one(7877448447392401135)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 8
2025/09/12 19:46:26 [1] S2 start one(6471682496798418191)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 9
2025/09/12 19:46:26 [1] S2 send APPEND ENTRIES RPC to server 0, prev 1, loglen 8, term 1
2025/09/12 19:46:26 [1] S2 send APPEND ENTRIES RPC to server 1, prev 2, loglen 7, term 1
2025/09/12 19:46:26 [1] S2 start one(6227721152322081503)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 10
2025/09/12 19:46:26 [1] S2 start one(8652772444434221604)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 11
2025/09/12 19:46:26 [1] S2 start one(4437682642675383484)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 12
2025/09/12 19:46:26 [1] S2 start one(905908085480527521)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 13
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 2 loglen 7 term 1
2025/09/12 19:46:26 [1] S1 , apply 2, commit 2, log 2, snapshot 0, len 3
2025/09/12 19:46:26 [1] S1 Append 7 logs, lastLogIndex = 9
2025/09/12 19:46:26 [1] S2 Update commit index to 9
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 13 loglen 0 term 1
2025/09/12 19:46:26 [1] S1 , apply 2, commit 2, log 9, snapshot 0, len 10
2025/09/12 19:46:26 [1] S2 Apply 7 logs to 9
2025/09/12 19:46:26 [1] S2 begin apply log 3
2025/09/12 19:46:26 [1] S2 APPLY , apply 2, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S2 end apply log 3
2025/09/12 19:46:26 [1] S2 begin apply log 4
2025/09/12 19:46:26 [1] S2 APPLY , apply 3, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S2 end apply log 4
2025/09/12 19:46:26 [1] S2 begin apply log 5
2025/09/12 19:46:26 [1] S2 APPLY , apply 4, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S2 end apply log 5
2025/09/12 19:46:26 [1] S2 begin apply log 6
2025/09/12 19:46:26 [1] S2 APPLY , apply 5, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S2 end apply log 6
2025/09/12 19:46:26 [1] S2 begin apply log 7
2025/09/12 19:46:26 [1] S2 APPLY , apply 6, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S2 end apply log 7
2025/09/12 19:46:26 [1] S2 begin apply log 8
2025/09/12 19:46:26 [1] S2 APPLY , apply 7, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S2 end apply log 8
2025/09/12 19:46:26 [1] S2 begin apply log 9
2025/09/12 19:46:26 [1] S2 APPLY , apply 8, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S2 end apply log 9
2025/09/12 19:46:26 [1] S2 SNAPSHOT at 9
2025/09/12 19:46:26 [1] S2 snapshot, apply 9, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S2 snapshot END, apply 9, commit 9, log 13, snapshot 9, len 5
==================
WARNING: DATA RACE
Read at 0x00c00016a4e8 by goroutine 23:
  6.5840/raft1.(*Raft).applier()
      /home/akane/learning/6.5840/src/raft1/commit.go:12 +0x84
  6.5840/raft1.Make.gowrap2()
      /home/akane/learning/6.5840/src/raft1/raft.go:90 +0x33

Previous write at 0x00c00016a4e8 by goroutine 26:
  6.5840/raft1.(*Raft).SnapShotWithoutLock()
      /home/akane/learning/6.5840/src/raft1/snapshot.go:103 +0x367
  6.5840/raft1.(*Raft).Snapshot()
      /home/akane/learning/6.5840/src/raft1/raft.go:60 +0x4e
  6.5840/raft1.(*rfsrv).applierSnap()
      /home/akane/learning/6.5840/src/raft1/server.go:154 +0x8de
  6.5840/raft1.newRfsrv.gowrap1()
      /home/akane/learning/6.5840/src/raft1/server.go:57 +0x44

Goroutine 23 (running) created at:
  6.5840/raft1.Make()
      /home/akane/learning/6.5840/src/raft1/raft.go:90 +0x44d
  6.5840/raft1.newRfsrv()
      /home/akane/learning/6.5840/src/raft1/server.go:44 +0x20c
  6.5840/raft1.(*Test).mksrv()
      /home/akane/learning/6.5840/src/raft1/test.go:52 +0x92
  6.5840/raft1.(*Test).mksrv-fm()
      <autogenerated>:1 +0x89
  6.5840/tester1.(*ServerGrp).StartServer()
      /home/akane/learning/6.5840/src/tester1/group.go:239 +0x247
  6.5840/tester1.(*ServerGrp).start()
      /home/akane/learning/6.5840/src/tester1/group.go:278 +0x5c
  6.5840/tester1.(*ServerGrp).StartServers()
      /home/akane/learning/6.5840/src/tester1/group.go:250 +0x35
  6.5840/tester1.(*Config).MakeGroupStart()
      /home/akane/learning/6.5840/src/tester1/config.go:92 +0x89
  6.5840/tester1.MakeConfig()
      /home/akane/learning/6.5840/src/tester1/config.go:49 +0x29e
  6.5840/raft1.makeTest()
      /home/akane/learning/6.5840/src/raft1/test.go:38 +0x1ee
  6.5840/raft1.snapcommon()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1229 +0x78
  6.5840/raft1.TestSnapshotInstallUnCrash3D()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1315 +0x3c
  testing.tRunner()
      /usr/lib/go-1.22/src/testing/testing.go:1689 +0x21e
  testing.(*T).Run.gowrap1()
      /usr/lib/go-1.22/src/testing/testing.go:1742 +0x44

Goroutine 26 (running) created at:
  6.5840/raft1.newRfsrv()
      /home/akane/learning/6.5840/src/raft1/server.go:57 +0x404
  6.5840/raft1.(*Test).mksrv()
      /home/akane/learning/6.5840/src/raft1/test.go:52 +0x92
  6.5840/raft1.(*Test).mksrv-fm()
      <autogenerated>:1 +0x89
  6.5840/tester1.(*ServerGrp).StartServer()
      /home/akane/learning/6.5840/src/tester1/group.go:239 +0x247
  6.5840/tester1.(*ServerGrp).start()
      /home/akane/learning/6.5840/src/tester1/group.go:278 +0x5c
  6.5840/tester1.(*ServerGrp).StartServers()
      /home/akane/learning/6.5840/src/tester1/group.go:250 +0x35
  6.5840/tester1.(*Config).MakeGroupStart()
      /home/akane/learning/6.5840/src/tester1/config.go:92 +0x89
  6.5840/tester1.MakeConfig()
      /home/akane/learning/6.5840/src/tester1/config.go:49 +0x29e
  6.5840/raft1.makeTest()
      /home/akane/learning/6.5840/src/raft1/test.go:38 +0x1ee
  6.5840/raft1.snapcommon()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1229 +0x78
  6.5840/raft1.TestSnapshotInstallUnCrash3D()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1315 +0x3c
  testing.tRunner()
      /usr/lib/go-1.22/src/testing/testing.go:1689 +0x21e
  testing.(*T).Run.gowrap1()
      /usr/lib/go-1.22/src/testing/testing.go:1742 +0x44
==================
==================
WARNING: DATA RACE
Read at 0x00c00016a4c8 by goroutine 183:
  6.5840/raft1.(*Raft).GetLastLogIndexWithoutLock()
      /home/akane/learning/6.5840/src/raft1/states.go:120 +0x84
  6.5840/raft1.(*Raft).UpdateCommitIndex()
      /home/akane/learning/6.5840/src/raft1/commit.go:38 +0x79
  6.5840/raft1.(*Raft).SendHeartbeat()
      /home/akane/learning/6.5840/src/raft1/election.go:12 +0x108
  6.5840/raft1.(*Raft).ticker.gowrap1()
      /home/akane/learning/6.5840/src/raft1/election.go:36 +0x33

Previous write at 0x00c00016a4c8 by goroutine 26:
  6.5840/raft1.(*Raft).SnapShotWithoutLock()
      /home/akane/learning/6.5840/src/raft1/snapshot.go:100 +0x248
  6.5840/raft1.(*Raft).Snapshot()
      /home/akane/learning/6.5840/src/raft1/raft.go:60 +0x4e
  6.5840/raft1.(*rfsrv).applierSnap()
      /home/akane/learning/6.5840/src/raft1/server.go:154 +0x8de
  6.5840/raft1.newRfsrv.gowrap1()
      /home/akane/learning/6.5840/src/raft1/server.go:57 +0x44

Goroutine 183 (running) created at:
  6.5840/raft1.(*Raft).ticker()
      /home/akane/learning/6.5840/src/raft1/election.go:36 +0x1fc
  6.5840/raft1.Make.gowrap1()
      /home/akane/learning/6.5840/src/raft1/raft.go:89 +0x33

Goroutine 26 (running) created at:
  6.5840/raft1.newRfsrv()
      /home/akane/learning/6.5840/src/raft1/server.go:57 +0x404
  6.5840/raft1.(*Test).mksrv()
      /home/akane/learning/6.5840/src/raft1/test.go:52 +0x92
  6.5840/raft1.(*Test).mksrv-fm()
      <autogenerated>:1 +0x89
  6.5840/tester1.(*ServerGrp).StartServer()
      /home/akane/learning/6.5840/src/tester1/group.go:239 +0x247
  6.5840/tester1.(*ServerGrp).start()
      /home/akane/learning/6.5840/src/tester1/group.go:278 +0x5c
  6.5840/tester1.(*ServerGrp).StartServers()
      /home/akane/learning/6.5840/src/tester1/group.go:250 +0x35
  6.5840/tester1.(*Config).MakeGroupStart()
      /home/akane/learning/6.5840/src/tester1/config.go:92 +0x89
  6.5840/tester1.MakeConfig()
      /home/akane/learning/6.5840/src/tester1/config.go:49 +0x29e
  6.5840/raft1.makeTest()
      /home/akane/learning/6.5840/src/raft1/test.go:38 +0x1ee
  6.5840/raft1.snapcommon()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1229 +0x78
  6.5840/raft1.TestSnapshotInstallUnCrash3D()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1315 +0x3c
  testing.tRunner()
      /usr/lib/go-1.22/src/testing/testing.go:1689 +0x21e
  testing.(*T).Run.gowrap1()
      /usr/lib/go-1.22/src/testing/testing.go:1742 +0x44
==================
==================
WARNING: DATA RACE
Read at 0x00c00016a568 by goroutine 183:
  6.5840/raft1.(*Raft).GetLastLogIndexWithoutLock()
      /home/akane/learning/6.5840/src/raft1/states.go:120 +0xa4
  6.5840/raft1.(*Raft).UpdateCommitIndex()
      /home/akane/learning/6.5840/src/raft1/commit.go:38 +0x79
  6.5840/raft1.(*Raft).SendHeartbeat()
      /home/akane/learning/6.5840/src/raft1/election.go:12 +0x108
  6.5840/raft1.(*Raft).ticker.gowrap1()
      /home/akane/learning/6.5840/src/raft1/election.go:36 +0x33

Previous write at 0x00c00016a568 by goroutine 26:
  6.5840/raft1.(*Raft).SnapShotWithoutLock()
      /home/akane/learning/6.5840/src/raft1/snapshot.go:101 +0x2b4
  6.5840/raft1.(*Raft).Snapshot()
      /home/akane/learning/6.5840/src/raft1/raft.go:60 +0x4e
  6.5840/raft1.(*rfsrv).applierSnap()
      /home/akane/learning/6.5840/src/raft1/server.go:154 +0x8de
  6.5840/raft1.newRfsrv.gowrap1()
      /home/akane/learning/6.5840/src/raft1/server.go:57 +0x44

Goroutine 183 (running) created at:
  6.5840/raft1.(*Raft).ticker()
      /home/akane/learning/6.5840/src/raft1/election.go:36 +0x1fc
  6.5840/raft1.Make.gowrap1()
      /home/akane/learning/6.5840/src/raft1/raft.go:89 +0x33

Goroutine 26 (running) created at:
  6.5840/raft1.newRfsrv()
      /home/akane/learning/6.5840/src/raft1/server.go:57 +0x404
  6.5840/raft1.(*Test).mksrv()
      /home/akane/learning/6.5840/src/raft1/test.go:52 +0x92
  6.5840/raft1.(*Test).mksrv-fm()
      <autogenerated>:1 +0x89
  6.5840/tester1.(*ServerGrp).StartServer()
      /home/akane/learning/6.5840/src/tester1/group.go:239 +0x247
  6.5840/tester1.(*ServerGrp).start()
      /home/akane/learning/6.5840/src/tester1/group.go:278 +0x5c
  6.5840/tester1.(*ServerGrp).StartServers()
      /home/akane/learning/6.5840/src/tester1/group.go:250 +0x35
  6.5840/tester1.(*Config).MakeGroupStart()
      /home/akane/learning/6.5840/src/tester1/config.go:92 +0x89
  6.5840/tester1.MakeConfig()
      /home/akane/learning/6.5840/src/tester1/config.go:49 +0x29e
  6.5840/raft1.makeTest()
      /home/akane/learning/6.5840/src/raft1/test.go:38 +0x1ee
  6.5840/raft1.snapcommon()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1229 +0x78
  6.5840/raft1.TestSnapshotInstallUnCrash3D()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1315 +0x3c
  testing.tRunner()
      /usr/lib/go-1.22/src/testing/testing.go:1689 +0x21e
  testing.(*T).Run.gowrap1()
      /usr/lib/go-1.22/src/testing/testing.go:1742 +0x44
==================
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 13 loglen 0 term 1
2025/09/12 19:46:26 [1] S1 , apply 2, commit 2, log 9, snapshot 0, len 10
2025/09/12 19:46:26 [1] S2 send APPEND ENTRIES RPC to server 1, prev 9, loglen 4, term 1
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 13 loglen 0 term 1
2025/09/12 19:46:26 [1] S1 , apply 2, commit 2, log 9, snapshot 0, len 10
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 13 loglen 0 term 1
2025/09/12 19:46:26 [1] S1 , apply 2, commit 2, log 9, snapshot 0, len 10
2025/09/12 19:46:26 [1] S2 send APPEND ENTRIES RPC to server 1, prev 9, loglen 4, term 1
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 9 loglen 4 term 1
2025/09/12 19:46:26 [1] S1 , apply 2, commit 2, log 9, snapshot 0, len 10
2025/09/12 19:46:26 [1] S1 Append 4 logs, lastLogIndex = 13
2025/09/12 19:46:26 [1] S1 Apply 7 logs to 9
2025/09/12 19:46:26 [1] S1 begin apply log 3
2025/09/12 19:46:26 [1] S1 APPLY , apply 2, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S1 end apply log 3
2025/09/12 19:46:26 [1] S1 begin apply log 4
2025/09/12 19:46:26 [1] S1 APPLY , apply 3, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S1 end apply log 4
2025/09/12 19:46:26 [1] S1 begin apply log 5
2025/09/12 19:46:26 [1] S1 APPLY , apply 4, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S1 end apply log 5
2025/09/12 19:46:26 [1] S1 begin apply log 6
2025/09/12 19:46:26 [1] S1 APPLY , apply 5, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S1 end apply log 6
2025/09/12 19:46:26 [1] S1 begin apply log 7
2025/09/12 19:46:26 [1] S1 APPLY , apply 6, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S1 end apply log 7
2025/09/12 19:46:26 [1] S1 begin apply log 8
2025/09/12 19:46:26 [1] S1 APPLY , apply 7, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S1 end apply log 8
2025/09/12 19:46:26 [1] S1 begin apply log 9
2025/09/12 19:46:26 [1] S1 APPLY , apply 8, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S1 end apply log 9
2025/09/12 19:46:26 [1] S1 SNAPSHOT at 9
2025/09/12 19:46:26 [1] S1 snapshot, apply 9, commit 9, log 13, snapshot 0, len 14
2025/09/12 19:46:26 [1] S1 snapshot END, apply 9, commit 9, log 13, snapshot 9, len 5
2025/09/12 19:46:26 [1] S2 Update commit index to 13
2025/09/12 19:46:26 [1] S2 Apply 4 logs to 13
2025/09/12 19:46:26 [1] S2 begin apply log 10
2025/09/12 19:46:26 [1] S2 APPLY , apply 9, commit 13, log 13, snapshot 9, len 5
2025/09/12 19:46:26 [1] S2 end apply log 10
2025/09/12 19:46:26 [1] S2 begin apply log 11
2025/09/12 19:46:26 [1] S2 APPLY , apply 10, commit 13, log 13, snapshot 9, len 5
2025/09/12 19:46:26 [1] S2 end apply log 11
2025/09/12 19:46:26 [1] S2 begin apply log 12
2025/09/12 19:46:26 [1] S2 APPLY , apply 11, commit 13, log 13, snapshot 9, len 5
2025/09/12 19:46:26 [1] S2 end apply log 12
2025/09/12 19:46:26 [1] S2 begin apply log 13
2025/09/12 19:46:26 [1] S2 APPLY , apply 12, commit 13, log 13, snapshot 9, len 5
2025/09/12 19:46:26 [1] S2 end apply log 13
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 13 loglen 0 term 1
2025/09/12 19:46:26 [1] S1 , apply 9, commit 9, log 13, snapshot 9, len 5
2025/09/12 19:46:26 [1] S1 Apply 4 logs to 13
2025/09/12 19:46:26 [1] S1 begin apply log 10
2025/09/12 19:46:26 [1] S1 APPLY , apply 9, commit 13, log 13, snapshot 9, len 5
2025/09/12 19:46:26 [1] S1 end apply log 10
2025/09/12 19:46:26 [1] S1 begin apply log 11
2025/09/12 19:46:26 [1] S1 APPLY , apply 10, commit 13, log 13, snapshot 9, len 5
2025/09/12 19:46:26 [1] S1 end apply log 11
2025/09/12 19:46:26 [1] S1 begin apply log 12
2025/09/12 19:46:26 [1] S1 APPLY , apply 11, commit 13, log 13, snapshot 9, len 5
2025/09/12 19:46:26 [1] S1 end apply log 12
2025/09/12 19:46:26 [1] S1 begin apply log 13
2025/09/12 19:46:26 [1] S1 APPLY , apply 12, commit 13, log 13, snapshot 9, len 5
2025/09/12 19:46:26 [1] S1 end apply log 13
2025/09/12 19:46:26 [1] S0 restart!!
2025/09/12 19:46:26 [1] S2 start one(8010020111910529078)
2025/09/12 19:46:26 [1] S2 Append 1 logs, lastLogIndex = 14
2025/09/12 19:46:26 [1] S2 send APPEND ENTRIES RPC to server 1, prev 13, loglen 1, term 1
2025/09/12 19:46:26 [1] S2 send InstallSnapshot to 0 at 9
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 13 loglen 1 term 1
2025/09/12 19:46:26 [1] S1 , apply 13, commit 13, log 13, snapshot 9, len 5
2025/09/12 19:46:26 [1] S1 Append 1 logs, lastLogIndex = 14
2025/09/12 19:46:26 [1] S0 InstallSnapshot start, apply 0, commit 0, log 1, snapshot 0, len 2
2025/09/12 19:46:26 [1] S0 InstallSnapshot end, apply 9, commit 9, log 9, snapshot 9, len 1
2025/09/12 19:46:26 [1] S2 HandleInstallReply from server 0 term 1
2025/09/12 19:46:26 [1] S2 InstallSnapshot update matchIndex 0 to 9
2025/09/12 19:46:26 [1] S2 Update commit index to 14
2025/09/12 19:46:26 [1] S1 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:26 [1] S1 , apply 13, commit 13, log 14, snapshot 9, len 6
2025/09/12 19:46:26 [1] S2 Apply 1 logs to 14
2025/09/12 19:46:26 [1] S2 begin apply log 14
2025/09/12 19:46:26 [1] S2 APPLY , apply 13, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:26 [1] S1 Apply 1 logs to 14
2025/09/12 19:46:26 [1] S2 end apply log 14
2025/09/12 19:46:26 [1] S1 begin apply log 14
2025/09/12 19:46:26 [1] S1 APPLY , apply 13, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:26 [1] S1 end apply log 14
2025/09/12 19:46:27 [1] S0 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:27 [1] S0 , apply 9, commit 9, log 9, snapshot 9, len 1
2025/09/12 19:46:27 [1] S1 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:27 [1] S1 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S0 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:27 [1] S0 , apply 9, commit 9, log 9, snapshot 9, len 1
2025/09/12 19:46:27 [1] S2 send APPEND ENTRIES RPC to server 0, prev 9, loglen 5, term 1
2025/09/12 19:46:27 [1] S0 Got append RPC with pervLogIndex 9 loglen 5 term 1
2025/09/12 19:46:27 [1] S0 , apply 9, commit 9, log 9, snapshot 9, len 1
2025/09/12 19:46:27 [1] S0 Append 5 logs, lastLogIndex = 14
2025/09/12 19:46:27 [1] S0 Apply 5 logs to 14
2025/09/12 19:46:27 [1] S0 begin apply log 10
2025/09/12 19:46:27 [1] S0 APPLY , apply 9, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S0 end apply log 10
2025/09/12 19:46:27 [1] S0 begin apply log 11
2025/09/12 19:46:27 [1] S0 APPLY , apply 10, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S0 end apply log 11
2025/09/12 19:46:27 [1] S0 begin apply log 12
2025/09/12 19:46:27 [1] S0 APPLY , apply 11, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S0 end apply log 12
2025/09/12 19:46:27 [1] S0 begin apply log 13
2025/09/12 19:46:27 [1] S0 APPLY , apply 12, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S0 end apply log 13
2025/09/12 19:46:27 [1] S0 begin apply log 14
2025/09/12 19:46:27 [1] S0 APPLY , apply 13, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S0 end apply log 14
2025/09/12 19:46:27 [1] S0 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:27 [1] S0 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S1 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:27 [1] S1 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S1 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:27 [1] S1 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S0 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:27 [1] S0 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S1 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:27 [1] S1 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S1 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:27 [1] S1 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S0 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:27 [1] S0 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S1 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:27 [1] S1 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:27 [1] S0 Got append RPC with pervLogIndex 14 loglen 0 term 1
2025/09/12 19:46:27 [1] S0 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:28 [2] S0 start election...
2025/09/12 19:46:28 [2] S0 Got Vote reply from 1, term 2
2025/09/12 19:46:28 [2] S0 Change to leader
2025/09/12 19:46:28 [2] S1 Got append RPC with pervLogIndex 14 loglen 0 term 2
2025/09/12 19:46:28 [2] S1 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:28 [2] S0 start one(8605271668316880667)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 15
2025/09/12 19:46:28 [2] S1 Got append RPC with pervLogIndex 15 loglen 0 term 2
2025/09/12 19:46:28 [2] S1 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:28 [2] S0 send APPEND ENTRIES RPC to server 1, prev 14, loglen 1, term 2
2025/09/12 19:46:28 [2] S1 Got append RPC with pervLogIndex 14 loglen 1 term 2
2025/09/12 19:46:28 [2] S1 , apply 14, commit 14, log 14, snapshot 9, len 6
2025/09/12 19:46:28 [2] S1 Append 1 logs, lastLogIndex = 15
2025/09/12 19:46:28 [2] S0 Update commit index to 15
2025/09/12 19:46:28 [2] S0 Apply 1 logs to 15
2025/09/12 19:46:28 [2] S0 begin apply log 15
2025/09/12 19:46:28 [2] S0 APPLY , apply 14, commit 15, log 15, snapshot 9, len 7
2025/09/12 19:46:28 [2] S0 end apply log 15
2025/09/12 19:46:28 [2] S1 Got append RPC with pervLogIndex 15 loglen 0 term 2
2025/09/12 19:46:28 [2] S1 , apply 14, commit 14, log 15, snapshot 9, len 7
2025/09/12 19:46:28 [2] S1 Apply 1 logs to 15
2025/09/12 19:46:28 [2] S1 begin apply log 15
2025/09/12 19:46:28 [2] S1 APPLY , apply 14, commit 15, log 15, snapshot 9, len 7
2025/09/12 19:46:28 [2] S1 end apply log 15
2025/09/12 19:46:28 [2] S0 start one(38190190087304830)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 16
2025/09/12 19:46:28 [2] S0 start one(4407784448581251029)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 17
2025/09/12 19:46:28 [2] S0 start one(27957449003338563)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 18
2025/09/12 19:46:28 [2] S0 start one(5184338212180293464)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 19
2025/09/12 19:46:28 [2] S0 start one(8752507103682415805)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 20
2025/09/12 19:46:28 [2] S0 start one(1533307959046911718)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 21
2025/09/12 19:46:28 [2] S0 start one(3818119707385572782)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 22
2025/09/12 19:46:28 [2] S0 start one(4953997806064037861)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 23
2025/09/12 19:46:28 [2] S0 send APPEND ENTRIES RPC to server 2, prev 14, loglen 9, term 2
2025/09/12 19:46:28 [2] S0 start one(8863453284168937785)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 24
2025/09/12 19:46:28 [2] S0 start one(100987200519893385)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 25
2025/09/12 19:46:28 [2] S0 start one(3828832795738204377)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 26
2025/09/12 19:46:28 [2] S1 Got append RPC with pervLogIndex 26 loglen 0 term 2
2025/09/12 19:46:28 [2] S1 , apply 15, commit 15, log 15, snapshot 9, len 7
2025/09/12 19:46:28 [2] S0 send APPEND ENTRIES RPC to server 1, prev 15, loglen 11, term 2
2025/09/12 19:46:28 [2] S1 Got append RPC with pervLogIndex 15 loglen 11 term 2
2025/09/12 19:46:28 [2] S1 , apply 15, commit 15, log 15, snapshot 9, len 7
2025/09/12 19:46:28 [2] S1 Append 11 logs, lastLogIndex = 26
2025/09/12 19:46:28 [2] S0 Update commit index to 26
2025/09/12 19:46:28 [2] S0 Apply 11 logs to 26
2025/09/12 19:46:28 [2] S0 begin apply log 16
2025/09/12 19:46:28 [2] S0 APPLY , apply 15, commit 26, log 26, snapshot 9, len 18
2025/09/12 19:46:28 [2] S0 end apply log 16
2025/09/12 19:46:28 [2] S0 begin apply log 17
2025/09/12 19:46:28 [2] S0 APPLY , apply 16, commit 26, log 26, snapshot 9, len 18
2025/09/12 19:46:28 [2] S0 end apply log 17
2025/09/12 19:46:28 [2] S0 begin apply log 18
2025/09/12 19:46:28 [2] S0 APPLY , apply 17, commit 26, log 26, snapshot 9, len 18
2025/09/12 19:46:28 [2] S0 end apply log 18
2025/09/12 19:46:28 [2] S0 begin apply log 19
2025/09/12 19:46:28 [2] S0 APPLY , apply 18, commit 26, log 26, snapshot 9, len 18
2025/09/12 19:46:28 [2] S0 end apply log 19
2025/09/12 19:46:28 [2] S0 begin apply log 20
2025/09/12 19:46:28 [2] S0 APPLY , apply 19, commit 26, log 26, snapshot 9, len 18
2025/09/12 19:46:28 [2] S0 SNAPSHOT at 19
==================
WARNING: DATA RACE
Read at 0x00c000336068 by goroutine 216:
  6.5840/raft1.mDebugIndex()
      /home/akane/learning/6.5840/src/raft1/util.go:35 +0x104
  6.5840/raft1.(*Raft).SnapShotWithoutLock()
      /home/akane/learning/6.5840/src/raft1/snapshot.go:94 +0xd1
  6.5840/raft1.(*Raft).Snapshot()
      /home/akane/learning/6.5840/src/raft1/raft.go:60 +0x4e
  6.5840/raft1.(*rfsrv).applierSnap()
      /home/akane/learning/6.5840/src/raft1/server.go:154 +0x8de
  6.5840/raft1.newRfsrv.gowrap1()
      /home/akane/learning/6.5840/src/raft1/server.go:57 +0x44

Previous write at 0x00c000336068 by goroutine 213:
  6.5840/raft1.(*Raft).ApplyCommittedLogs()
      /home/akane/learning/6.5840/src/raft1/commit.go:26 +0x1af
  6.5840/raft1.(*Raft).applier()
      /home/akane/learning/6.5840/src/raft1/commit.go:13 +0x99
  6.5840/raft1.Make.gowrap2()
      /home/akane/learning/6.5840/src/raft1/raft.go:90 +0x33

Goroutine 216 (running) created at:
  6.5840/raft1.newRfsrv()
      /home/akane/learning/6.5840/src/raft1/server.go:57 +0x404
  6.5840/raft1.(*Test).mksrv()
      /home/akane/learning/6.5840/src/raft1/test.go:52 +0x92
  6.5840/raft1.(*Test).mksrv-fm()
      <autogenerated>:1 +0x89
  6.5840/tester1.(*ServerGrp).StartServer()
      /home/akane/learning/6.5840/src/tester1/group.go:239 +0x247
  6.5840/raft1.(*Test).restart()
      /home/akane/learning/6.5840/src/raft1/test.go:60 +0x4b
  6.5840/raft1.snapcommon()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1289 +0x6fc
  6.5840/raft1.TestSnapshotInstallUnCrash3D()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1315 +0x3c
  testing.tRunner()
      /usr/lib/go-1.22/src/testing/testing.go:1689 +0x21e
  testing.(*T).Run.gowrap1()
      /usr/lib/go-1.22/src/testing/testing.go:1742 +0x44

Goroutine 213 (running) created at:
  6.5840/raft1.Make()
      /home/akane/learning/6.5840/src/raft1/raft.go:90 +0x44d
  6.5840/raft1.newRfsrv()
      /home/akane/learning/6.5840/src/raft1/server.go:44 +0x20c
  6.5840/raft1.(*Test).mksrv()
      /home/akane/learning/6.5840/src/raft1/test.go:52 +0x92
  6.5840/raft1.(*Test).mksrv-fm()
      <autogenerated>:1 +0x89
  6.5840/tester1.(*ServerGrp).StartServer()
      /home/akane/learning/6.5840/src/tester1/group.go:239 +0x247
  6.5840/raft1.(*Test).restart()
      /home/akane/learning/6.5840/src/raft1/test.go:60 +0x4b
  6.5840/raft1.snapcommon()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1289 +0x6fc
  6.5840/raft1.TestSnapshotInstallUnCrash3D()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1315 +0x3c
  testing.tRunner()
      /usr/lib/go-1.22/src/testing/testing.go:1689 +0x21e
  testing.(*T).Run.gowrap1()
      /usr/lib/go-1.22/src/testing/testing.go:1742 +0x44
==================
2025/09/12 19:46:28 [2] S0 snapshot, apply 20, commit 26, log 26, snapshot 9, len 18
==================
WARNING: DATA RACE
Write at 0x00c000336048 by goroutine 216:
  6.5840/raft1.(*Raft).SnapShotWithoutLock()
      /home/akane/learning/6.5840/src/raft1/snapshot.go:100 +0x248
  6.5840/raft1.(*Raft).Snapshot()
      /home/akane/learning/6.5840/src/raft1/raft.go:60 +0x4e
  6.5840/raft1.(*rfsrv).applierSnap()
      /home/akane/learning/6.5840/src/raft1/server.go:154 +0x8de
  6.5840/raft1.newRfsrv.gowrap1()
      /home/akane/learning/6.5840/src/raft1/server.go:57 +0x44

Previous read at 0x00c000336048 by goroutine 213:
  6.5840/raft1.(*Raft).GetLogAtIndexWithoutLock()
      /home/akane/learning/6.5840/src/raft1/states.go:125 +0x3b2
  6.5840/raft1.(*Raft).ApplyCommittedLogs()
      /home/akane/learning/6.5840/src/raft1/commit.go:25 +0x389
  6.5840/raft1.(*Raft).applier()
      /home/akane/learning/6.5840/src/raft1/commit.go:13 +0x99
  6.5840/raft1.Make.gowrap2()
      /home/akane/learning/6.5840/src/raft1/raft.go:90 +0x33

Goroutine 216 (running) created at:
  6.5840/raft1.newRfsrv()
      /home/akane/learning/6.5840/src/raft1/server.go:57 +0x404
  6.5840/raft1.(*Test).mksrv()
      /home/akane/learning/6.5840/src/raft1/test.go:52 +0x92
  6.5840/raft1.(*Test).mksrv-fm()
      <autogenerated>:1 +0x89
  6.5840/tester1.(*ServerGrp).StartServer()
      /home/akane/learning/6.5840/src/tester1/group.go:239 +0x247
  6.5840/raft1.(*Test).restart()
      /home/akane/learning/6.5840/src/raft1/test.go:60 +0x4b
  6.5840/raft1.snapcommon()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1289 +0x6fc
  6.5840/raft1.TestSnapshotInstallUnCrash3D()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1315 +0x3c
  testing.tRunner()
      /usr/lib/go-1.22/src/testing/testing.go:1689 +0x21e
  testing.(*T).Run.gowrap1()
      /usr/lib/go-1.22/src/testing/testing.go:1742 +0x44

Goroutine 213 (running) created at:
  6.5840/raft1.Make()
      /home/akane/learning/6.5840/src/raft1/raft.go:90 +0x44d
  6.5840/raft1.newRfsrv()
      /home/akane/learning/6.5840/src/raft1/server.go:44 +0x20c
  6.5840/raft1.(*Test).mksrv()
      /home/akane/learning/6.5840/src/raft1/test.go:52 +0x92
  6.5840/raft1.(*Test).mksrv-fm()
      <autogenerated>:1 +0x89
  6.5840/tester1.(*ServerGrp).StartServer()
      /home/akane/learning/6.5840/src/tester1/group.go:239 +0x247
  6.5840/raft1.(*Test).restart()
      /home/akane/learning/6.5840/src/raft1/test.go:60 +0x4b
  6.5840/raft1.snapcommon()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1289 +0x6fc
  6.5840/raft1.TestSnapshotInstallUnCrash3D()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1315 +0x3c
  testing.tRunner()
      /usr/lib/go-1.22/src/testing/testing.go:1689 +0x21e
  testing.(*T).Run.gowrap1()
      /usr/lib/go-1.22/src/testing/testing.go:1742 +0x44
==================
==================
WARNING: DATA RACE
Write at 0x00c0003360e8 by goroutine 216:
  6.5840/raft1.(*Raft).SnapShotWithoutLock()
      /home/akane/learning/6.5840/src/raft1/snapshot.go:101 +0x2b4
  6.5840/raft1.(*Raft).Snapshot()
      /home/akane/learning/6.5840/src/raft1/raft.go:60 +0x4e
  6.5840/raft1.(*rfsrv).applierSnap()
      /home/akane/learning/6.5840/src/raft1/server.go:154 +0x8de
  6.5840/raft1.newRfsrv.gowrap1()
      /home/akane/learning/6.5840/src/raft1/server.go:57 +0x44

Previous read at 0x00c0003360e8 by goroutine 213:
  6.5840/raft1.(*Raft).GetLogAtIndexWithoutLock()
      /home/akane/learning/6.5840/src/raft1/states.go:124 +0x391
  6.5840/raft1.(*Raft).ApplyCommittedLogs()
      /home/akane/learning/6.5840/src/raft1/commit.go:25 +0x389
  6.5840/raft1.(*Raft).applier()
      /home/akane/learning/6.5840/src/raft1/commit.go:13 +0x99
  6.5840/raft1.Make.gowrap2()
      /home/akane/learning/6.5840/src/raft1/raft.go:90 +0x33

Goroutine 216 (running) created at:
  6.5840/raft1.newRfsrv()
      /home/akane/learning/6.5840/src/raft1/server.go:57 +0x404
  6.5840/raft1.(*Test).mksrv()
      /home/akane/learning/6.5840/src/raft1/test.go:52 +0x92
  6.5840/raft1.(*Test).mksrv-fm()
      <autogenerated>:1 +0x89
  6.5840/tester1.(*ServerGrp).StartServer()
      /home/akane/learning/6.5840/src/tester1/group.go:239 +0x247
  6.5840/raft1.(*Test).restart()
      /home/akane/learning/6.5840/src/raft1/test.go:60 +0x4b
  6.5840/raft1.snapcommon()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1289 +0x6fc
  6.5840/raft1.TestSnapshotInstallUnCrash3D()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1315 +0x3c
  testing.tRunner()
      /usr/lib/go-1.22/src/testing/testing.go:1689 +0x21e
  testing.(*T).Run.gowrap1()
      /usr/lib/go-1.22/src/testing/testing.go:1742 +0x44

Goroutine 213 (running) created at:
  6.5840/raft1.Make()
      /home/akane/learning/6.5840/src/raft1/raft.go:90 +0x44d
  6.5840/raft1.newRfsrv()
      /home/akane/learning/6.5840/src/raft1/server.go:44 +0x20c
  6.5840/raft1.(*Test).mksrv()
      /home/akane/learning/6.5840/src/raft1/test.go:52 +0x92
  6.5840/raft1.(*Test).mksrv-fm()
      <autogenerated>:1 +0x89
  6.5840/tester1.(*ServerGrp).StartServer()
      /home/akane/learning/6.5840/src/tester1/group.go:239 +0x247
  6.5840/raft1.(*Test).restart()
      /home/akane/learning/6.5840/src/raft1/test.go:60 +0x4b
  6.5840/raft1.snapcommon()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1289 +0x6fc
  6.5840/raft1.TestSnapshotInstallUnCrash3D()
      /home/akane/learning/6.5840/src/raft1/raft_test.go:1315 +0x3c
  testing.tRunner()
      /usr/lib/go-1.22/src/testing/testing.go:1689 +0x21e
  testing.(*T).Run.gowrap1()
      /usr/lib/go-1.22/src/testing/testing.go:1742 +0x44
==================
2025/09/12 19:46:28 [2] S0 snapshot END, apply 20, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S0 end apply log 20
2025/09/12 19:46:28 [2] S0 begin apply log 21
2025/09/12 19:46:28 [2] S0 APPLY , apply 20, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S0 end apply log 21
2025/09/12 19:46:28 [2] S0 begin apply log 22
2025/09/12 19:46:28 [2] S0 APPLY , apply 21, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S0 end apply log 22
2025/09/12 19:46:28 [2] S0 begin apply log 23
2025/09/12 19:46:28 [2] S0 APPLY , apply 22, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S0 end apply log 23
2025/09/12 19:46:28 [2] S0 begin apply log 24
2025/09/12 19:46:28 [2] S0 APPLY , apply 23, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S0 end apply log 24
2025/09/12 19:46:28 [2] S0 begin apply log 25
2025/09/12 19:46:28 [2] S0 APPLY , apply 24, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S0 end apply log 25
2025/09/12 19:46:28 [2] S0 begin apply log 26
2025/09/12 19:46:28 [2] S0 APPLY , apply 25, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S0 end apply log 26
2025/09/12 19:46:28 [2] S1 Got append RPC with pervLogIndex 26 loglen 0 term 2
2025/09/12 19:46:28 [2] S1 , apply 15, commit 15, log 26, snapshot 9, len 18
2025/09/12 19:46:28 [2] S1 Apply 11 logs to 26
2025/09/12 19:46:28 [2] S1 begin apply log 16
2025/09/12 19:46:28 [2] S1 APPLY , apply 15, commit 26, log 26, snapshot 9, len 18
2025/09/12 19:46:28 [2] S1 end apply log 16
2025/09/12 19:46:28 [2] S1 begin apply log 17
2025/09/12 19:46:28 [2] S1 APPLY , apply 16, commit 26, log 26, snapshot 9, len 18
2025/09/12 19:46:28 [2] S1 end apply log 17
2025/09/12 19:46:28 [2] S1 begin apply log 18
2025/09/12 19:46:28 [2] S1 APPLY , apply 17, commit 26, log 26, snapshot 9, len 18
2025/09/12 19:46:28 [2] S1 end apply log 18
2025/09/12 19:46:28 [2] S1 begin apply log 19
2025/09/12 19:46:28 [2] S1 APPLY , apply 18, commit 26, log 26, snapshot 9, len 18
2025/09/12 19:46:28 [2] S1 end apply log 19
2025/09/12 19:46:28 [2] S1 begin apply log 20
2025/09/12 19:46:28 [2] S1 APPLY , apply 19, commit 26, log 26, snapshot 9, len 18
2025/09/12 19:46:28 [2] S1 SNAPSHOT at 19
2025/09/12 19:46:28 [2] S1 snapshot, apply 20, commit 26, log 26, snapshot 9, len 18
2025/09/12 19:46:28 [2] S1 snapshot END, apply 20, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S1 end apply log 20
2025/09/12 19:46:28 [2] S1 begin apply log 21
2025/09/12 19:46:28 [2] S1 APPLY , apply 20, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S1 end apply log 21
2025/09/12 19:46:28 [2] S1 begin apply log 22
2025/09/12 19:46:28 [2] S1 APPLY , apply 21, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S1 end apply log 22
2025/09/12 19:46:28 [2] S1 begin apply log 23
2025/09/12 19:46:28 [2] S1 APPLY , apply 22, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S1 end apply log 23
2025/09/12 19:46:28 [2] S1 begin apply log 24
2025/09/12 19:46:28 [2] S1 APPLY , apply 23, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S1 end apply log 24
2025/09/12 19:46:28 [2] S1 begin apply log 25
2025/09/12 19:46:28 [2] S1 APPLY , apply 24, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S1 end apply log 25
2025/09/12 19:46:28 [2] S1 begin apply log 26
2025/09/12 19:46:28 [2] S1 APPLY , apply 25, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S1 end apply log 26
2025/09/12 19:46:28 [1] S2 restart!!
2025/09/12 19:46:28 [2] S0 start one(1515970586369828700)
2025/09/12 19:46:28 [2] S0 Append 1 logs, lastLogIndex = 27
2025/09/12 19:46:28 [2] S0 send InstallSnapshot to 2 at 19
2025/09/12 19:46:28 [2] S0 send APPEND ENTRIES RPC to server 1, prev 26, loglen 1, term 2
2025/09/12 19:46:28 [2] S1 Got append RPC with pervLogIndex 26 loglen 1 term 2
2025/09/12 19:46:28 [2] S1 , apply 26, commit 26, log 26, snapshot 19, len 8
2025/09/12 19:46:28 [2] S1 Append 1 logs, lastLogIndex = 27
2025/09/12 19:46:28 [1] S2 InstallSnapshot start, apply 9, commit 9, log 14, snapshot 9, len 6
2025/09/12 19:46:28 [2] S2 InstallSnapshot end, apply 19, commit 19, log 19, snapshot 19, len 1
2025/09/12 19:46:28 [2] S0 HandleInstallReply from server 2 term 2
2025/09/12 19:46:28 [2] S0 InstallSnapshot update matchIndex 2 to 19
2025/09/12 19:46:28 [2] S0 Update commit index to 27
2025/09/12 19:46:28 [2] S1 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:28 [2] S1 , apply 26, commit 26, log 27, snapshot 19, len 9
2025/09/12 19:46:28 [2] S1 Apply 1 logs to 27
2025/09/12 19:46:28 [2] S1 begin apply log 27
2025/09/12 19:46:28 [2] S1 APPLY , apply 26, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:28 [2] S1 end apply log 27
2025/09/12 19:46:28 [2] S0 Apply 1 logs to 27
2025/09/12 19:46:28 [2] S0 begin apply log 27
2025/09/12 19:46:28 [2] S0 APPLY , apply 26, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:28 [2] S0 end apply log 27
2025/09/12 19:46:28 [2] S2 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:28 [2] S2 , apply 19, commit 19, log 19, snapshot 19, len 1
2025/09/12 19:46:28 [2] S1 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:28 [2] S1 , apply 27, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:28 [2] S2 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:28 [2] S2 , apply 19, commit 19, log 19, snapshot 19, len 1
2025/09/12 19:46:28 [2] S0 send APPEND ENTRIES RPC to server 2, prev 19, loglen 8, term 2
2025/09/12 19:46:28 [2] S2 Got append RPC with pervLogIndex 19 loglen 8 term 2
2025/09/12 19:46:28 [2] S2 , apply 19, commit 19, log 19, snapshot 19, len 1
2025/09/12 19:46:28 [2] S2 Append 8 logs, lastLogIndex = 27
2025/09/12 19:46:28 [2] S2 Apply 8 logs to 27
2025/09/12 19:46:28 [2] S2 begin apply log 20
2025/09/12 19:46:28 [2] S2 APPLY , apply 19, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:28 [2] S2 end apply log 20
2025/09/12 19:46:28 [2] S2 begin apply log 21
2025/09/12 19:46:28 [2] S2 APPLY , apply 20, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:28 [2] S2 end apply log 21
2025/09/12 19:46:28 [2] S2 begin apply log 22
2025/09/12 19:46:28 [2] S2 APPLY , apply 21, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:28 [2] S2 end apply log 22
2025/09/12 19:46:28 [2] S2 begin apply log 23
2025/09/12 19:46:28 [2] S2 APPLY , apply 22, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:28 [2] S2 end apply log 23
2025/09/12 19:46:28 [2] S2 begin apply log 24
2025/09/12 19:46:28 [2] S2 APPLY , apply 23, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:28 [2] S2 end apply log 24
2025/09/12 19:46:28 [2] S2 begin apply log 25
2025/09/12 19:46:28 [2] S2 APPLY , apply 24, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:28 [2] S2 end apply log 25
2025/09/12 19:46:28 [2] S2 begin apply log 26
2025/09/12 19:46:28 [2] S2 APPLY , apply 25, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:28 [2] S2 end apply log 26
2025/09/12 19:46:28 [2] S2 begin apply log 27
2025/09/12 19:46:28 [2] S2 APPLY , apply 26, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:28 [2] S2 end apply log 27
2025/09/12 19:46:29 [2] S2 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:29 [2] S2 , apply 27, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:29 [2] S1 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:29 [2] S1 , apply 27, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:29 [2] S1 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:29 [2] S1 , apply 27, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:29 [2] S2 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:29 [2] S2 , apply 27, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:29 [2] S2 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:29 [2] S2 , apply 27, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:29 [2] S1 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:29 [2] S1 , apply 27, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:29 [2] S1 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:29 [2] S1 , apply 27, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:29 [2] S2 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:29 [2] S2 , apply 27, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:29 [2] S2 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:29 [2] S2 , apply 27, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:29 [2] S1 Got append RPC with pervLogIndex 27 loglen 0 term 2
2025/09/12 19:46:29 [2] S1 , apply 27, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:29 [2] S0 start one(4516084176385767799)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 28
2025/09/12 19:46:29 [2] S0 send APPEND ENTRIES RPC to server 1, prev 27, loglen 1, term 2
2025/09/12 19:46:29 [2] S0 send APPEND ENTRIES RPC to server 2, prev 27, loglen 1, term 2
2025/09/12 19:46:29 [2] S2 Got append RPC with pervLogIndex 27 loglen 1 term 2
2025/09/12 19:46:29 [2] S2 , apply 27, commit 27, log 27, snapshot 19, len 9
2025/09/12 19:46:29 [2] S2 Append 1 logs, lastLogIndex = 28
2025/09/12 19:46:29 [2] S0 Update commit index to 28
2025/09/12 19:46:29 [2] S0 Apply 1 logs to 28
2025/09/12 19:46:29 [2] S0 begin apply log 28
2025/09/12 19:46:29 [2] S0 APPLY , apply 27, commit 28, log 28, snapshot 19, len 10
2025/09/12 19:46:29 [2] S0 end apply log 28
2025/09/12 19:46:29 [2] S2 Got append RPC with pervLogIndex 28 loglen 0 term 2
2025/09/12 19:46:29 [2] S2 , apply 27, commit 27, log 28, snapshot 19, len 10
2025/09/12 19:46:29 [2] S2 Apply 1 logs to 28
2025/09/12 19:46:29 [2] S2 begin apply log 28
2025/09/12 19:46:29 [2] S2 APPLY , apply 27, commit 28, log 28, snapshot 19, len 10
2025/09/12 19:46:29 [2] S2 end apply log 28
2025/09/12 19:46:29 [2] S0 start one(210438083605335112)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 29
2025/09/12 19:46:29 [2] S0 start one(6251779066370356607)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 30
2025/09/12 19:46:29 [2] S0 start one(6878133537657829910)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 31
2025/09/12 19:46:29 [2] S0 start one(8996564088577830416)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 32
2025/09/12 19:46:29 [2] S0 start one(5459477640635966347)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 33
2025/09/12 19:46:29 [2] S0 start one(1413637033574085592)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 34
2025/09/12 19:46:29 [2] S0 start one(3655651756084755321)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 35
2025/09/12 19:46:29 [2] S0 start one(5326654678974133250)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 36
2025/09/12 19:46:29 [2] S0 start one(8412102626537288182)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 37
2025/09/12 19:46:29 [2] S0 start one(1789513554809424999)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 38
2025/09/12 19:46:29 [2] S0 start one(7222639177098758450)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 39
2025/09/12 19:46:29 [2] S2 Got append RPC with pervLogIndex 39 loglen 0 term 2
2025/09/12 19:46:29 [2] S2 , apply 28, commit 28, log 28, snapshot 19, len 10
2025/09/12 19:46:29 [2] S0 send APPEND ENTRIES RPC to server 2, prev 28, loglen 11, term 2
2025/09/12 19:46:29 [2] S2 Got append RPC with pervLogIndex 28 loglen 11 term 2
2025/09/12 19:46:29 [2] S2 , apply 28, commit 28, log 28, snapshot 19, len 10
2025/09/12 19:46:29 [2] S2 Append 11 logs, lastLogIndex = 39
2025/09/12 19:46:29 [2] S0 Update commit index to 39
2025/09/12 19:46:29 [2] S0 Apply 11 logs to 39
2025/09/12 19:46:29 [2] S0 begin apply log 29
2025/09/12 19:46:29 [2] S0 APPLY , apply 28, commit 39, log 39, snapshot 19, len 21
2025/09/12 19:46:29 [2] S0 end apply log 29
2025/09/12 19:46:29 [2] S0 begin apply log 30
2025/09/12 19:46:29 [2] S0 APPLY , apply 29, commit 39, log 39, snapshot 19, len 21
2025/09/12 19:46:29 [2] S0 SNAPSHOT at 29
2025/09/12 19:46:29 [2] S0 snapshot, apply 30, commit 39, log 39, snapshot 19, len 21
2025/09/12 19:46:29 [2] S0 snapshot END, apply 30, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S0 end apply log 30
2025/09/12 19:46:29 [2] S0 begin apply log 31
2025/09/12 19:46:29 [2] S0 APPLY , apply 30, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S0 end apply log 31
2025/09/12 19:46:29 [2] S0 begin apply log 32
2025/09/12 19:46:29 [2] S0 APPLY , apply 31, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S0 end apply log 32
2025/09/12 19:46:29 [2] S0 begin apply log 33
2025/09/12 19:46:29 [2] S0 APPLY , apply 32, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S0 end apply log 33
2025/09/12 19:46:29 [2] S0 begin apply log 34
2025/09/12 19:46:29 [2] S0 APPLY , apply 33, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S0 end apply log 34
2025/09/12 19:46:29 [2] S0 begin apply log 35
2025/09/12 19:46:29 [2] S0 APPLY , apply 34, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S0 end apply log 35
2025/09/12 19:46:29 [2] S0 begin apply log 36
2025/09/12 19:46:29 [2] S0 APPLY , apply 35, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S0 end apply log 36
2025/09/12 19:46:29 [2] S0 begin apply log 37
2025/09/12 19:46:29 [2] S0 APPLY , apply 36, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S0 end apply log 37
2025/09/12 19:46:29 [2] S0 begin apply log 38
2025/09/12 19:46:29 [2] S0 APPLY , apply 37, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S0 end apply log 38
2025/09/12 19:46:29 [2] S0 begin apply log 39
2025/09/12 19:46:29 [2] S0 APPLY , apply 38, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S0 end apply log 39
2025/09/12 19:46:29 [2] S0 SNAPSHOT at 39
2025/09/12 19:46:29 [2] S0 snapshot, apply 39, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S0 snapshot END, apply 39, commit 39, log 39, snapshot 39, len 1
2025/09/12 19:46:29 [2] S2 Got append RPC with pervLogIndex 39 loglen 0 term 2
2025/09/12 19:46:29 [2] S2 , apply 28, commit 28, log 39, snapshot 19, len 21
2025/09/12 19:46:29 [2] S2 Apply 11 logs to 39
2025/09/12 19:46:29 [2] S2 begin apply log 29
2025/09/12 19:46:29 [2] S2 APPLY , apply 28, commit 39, log 39, snapshot 19, len 21
2025/09/12 19:46:29 [2] S2 end apply log 29
2025/09/12 19:46:29 [2] S2 begin apply log 30
2025/09/12 19:46:29 [2] S2 APPLY , apply 29, commit 39, log 39, snapshot 19, len 21
2025/09/12 19:46:29 [2] S2 SNAPSHOT at 29
2025/09/12 19:46:29 [2] S2 snapshot, apply 30, commit 39, log 39, snapshot 19, len 21
2025/09/12 19:46:29 [2] S2 snapshot END, apply 30, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S2 end apply log 30
2025/09/12 19:46:29 [2] S2 begin apply log 31
2025/09/12 19:46:29 [2] S2 APPLY , apply 30, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S2 end apply log 31
2025/09/12 19:46:29 [2] S2 begin apply log 32
2025/09/12 19:46:29 [2] S2 APPLY , apply 31, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S2 end apply log 32
2025/09/12 19:46:29 [2] S2 begin apply log 33
2025/09/12 19:46:29 [2] S2 APPLY , apply 32, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S2 end apply log 33
2025/09/12 19:46:29 [2] S2 begin apply log 34
2025/09/12 19:46:29 [2] S2 APPLY , apply 33, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S2 end apply log 34
2025/09/12 19:46:29 [2] S2 begin apply log 35
2025/09/12 19:46:29 [2] S2 APPLY , apply 34, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S2 end apply log 35
2025/09/12 19:46:29 [2] S2 begin apply log 36
2025/09/12 19:46:29 [2] S2 APPLY , apply 35, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S2 end apply log 36
2025/09/12 19:46:29 [2] S2 begin apply log 37
2025/09/12 19:46:29 [2] S2 APPLY , apply 36, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S2 end apply log 37
2025/09/12 19:46:29 [2] S2 begin apply log 38
2025/09/12 19:46:29 [2] S2 APPLY , apply 37, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S2 end apply log 38
2025/09/12 19:46:29 [2] S2 begin apply log 39
2025/09/12 19:46:29 [2] S2 APPLY , apply 38, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S2 end apply log 39
2025/09/12 19:46:29 [2] S2 SNAPSHOT at 39
2025/09/12 19:46:29 [2] S2 snapshot, apply 39, commit 39, log 39, snapshot 29, len 11
2025/09/12 19:46:29 [2] S2 snapshot END, apply 39, commit 39, log 39, snapshot 39, len 1
2025/09/12 19:46:29 [2] S1 restart!!
2025/09/12 19:46:29 [2] S0 start one(6139288975035270694)
2025/09/12 19:46:29 [2] S0 Append 1 logs, lastLogIndex = 40
2025/09/12 19:46:29 [2] S0 send APPEND ENTRIES RPC to server 2, prev 39, loglen 1, term 2
2025/09/12 19:46:29 [2] S0 send InstallSnapshot to 1 at 39
2025/09/12 19:46:27 [2] S2 Got append RPC with pervLogIndex 39 loglen 1 term 2
2025/09/12 19:46:27 [2] S2 , apply 39, commit 39, log 39, snapshot 39, len 1
2025/09/12 19:46:27 [2] S2 Append 1 logs, lastLogIndex = 40
2025/09/12 19:46:27 [2] S0 Update commit index to 40
2025/09/12 19:46:27 [2] S0 Apply 1 logs to 40
2025/09/12 19:46:27 [2] S0 begin apply log 40
2025/09/12 19:46:27 [2] S0 APPLY , apply 39, commit 40, log 40, snapshot 39, len 2
2025/09/12 19:46:27 [2] S0 end apply log 40
2025/09/12 19:46:27 [2] S1 Got append RPC with pervLogIndex 40 loglen 0 term 2
2025/09/12 19:46:27 [2] S1 , apply 19, commit 19, log 27, snapshot 19, len 9
2025/09/12 19:46:27 [2] S0 Reject handle append RPC without Backforwards
2025/09/12 19:46:27 [2] S2 Got append RPC with pervLogIndex 40 loglen 0 term 2
2025/09/12 19:46:27 [2] S2 , apply 39, commit 39, log 40, snapshot 39, len 2
info: wrote visualization to /tmp/porcupine-2025256986.html
exit status 1
FAIL	6.5840/raft1	5.014s
